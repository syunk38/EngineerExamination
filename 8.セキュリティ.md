## セキュリティ

### 情報システムの運用には以下の様なリスクがある
- 盗聴
- 改ざん
- なりすまし

### 盗聴リスクに対する措置
- →暗号化
暗号化
	- 平文をある規則で変換し、意味のない文字列や図案として表現したもの

### 暗号化のルール
- 平文を暗号化できるルールが有ること
- 暗号を平文に戻せる（複合）ルールが有ること

### 暗号化された情報を盗聴しようとする人物の手口
- キーを不正な手段で入手しようとする
- 暗号の特性から変換ルールを推定し、キーがなくても暗号から平文を得ようとする。

### 換字式
- ある暗号化ルールで文字列を意味のない文字列に変換する。

### 暗号化に必要な要素
- キーを他人が入手できないように厳重に管理すること
- 変換ルールを複雑にして、推測できないようにすること
- コンピュータの性能向上により、暗号の解読方法が確立されてしまうこともある。

### 暗号化方式の種類
- 共通鍵暗号方式
- 公開鍵暗号方式

### 共通鍵暗号方式
- 暗号化と復号化のキーが同一
- 送信者と受信者が同じキーを持つ
- 通信が相手が増えると管理する鍵の数が増え、鍵管理の負担が大きくなる
	- n人の通信相手が相互に通信する場合
	    - n(n-1)/2個の鍵が必要
	        - 6人なら…
	        - 6(6-1)/2 = 15この鍵が必要
- 秘密鍵の配布方法が手間になる
	- メールに添付したりすると、第三者に渡ってしまうおそれがある。

### 共通暗号鍵の実装方式
- DES
	- Data Encryption Standard
	- 2の56乗のパターンが有る。
	- 平文を8バイトのブロックに分割
	- 変換処理を16回繰り返す
	- コンピュータの性能向上により解読可能になってきた。
	- AES、Triple DES、FEAL、IDEAなどがある。

### 公開鍵暗号方式
- 暗号化と復号化の鍵を別々にしたもの
- 公開鍵は誰でも利用できる
- 復号鍵は受信者のみが管理する
- 受信者だけが復号化して文章を読むことができる。
- 送信者は秘密鍵を１つ持っていればいいので、鍵管理の負担が少ない
- 共通暗号鍵に比べて暗号化、復号化に時間が掛かる

### 公開鍵暗号の実装方式
- RSA

### ハイブリッド方式
- 公開鍵方式は共通鍵の配布時と鍵管理の問題を解決する代わりに、演算にコストがかかる。
- そこで、共通鍵の配布を公開鍵方式で行い、データの暗号化、復号化は共通鍵を方式を用いる。
- PGP
    - メールの暗号化方式
- S/MIME
- SSL

### 無線LAN
- 電波や赤外線を利用したネットワーク
- IEEE802.11シリーズの規格
    - b
        - 11Mbps
        - 2.4GHz
    - a
        - 54Mbps
        - 5GHz
    - g
        - 54Mbps
        - 2.4GHz
    - n
        - 600Mbps
        - 5/2.4GHz
    - (acはないのか…？)
        - 6900Mbps
        - 5GHz
- PIAFS
    - PHSとコンピュータの間の通信規格
- CSMA/CA
    - 無線LANでのアクセス制御方式
    - 無線LANではコリジョン（データの衝突）を検出できない
    - 衝突を回避できる
- SSID
    - 実は旧規格
    - 次世代規格のESSIDが使われている
    - アクセスポイントの選択に用いられる
- AP（アクセスポイント）
    - 無線の場合、幾つものAPにつなぐことができる
    - ESSIDを「ANY」にすると、どのAPにも接続できるようになる
        - →セキュリティ的に危ないので拒否する設定もある。
    - MACアドレスフィルタリング
    - ESSIDを公開しないステルスモードがある
- WEP
    - 802.11bで規定されている暗号化方式
    - 無線LANのアクセスポイントとクライアント間の通信を暗号化する
    - WEPキーはアクセスポイントごとに設定される
    - キー長が短いため、総当たり攻撃で解析される脆弱性がある。
    - 他にもWEPキーが固定だったり、ICVと呼ばれる固定キーの長さが不十分だったり
    - IEEE802.1X認証でセキュリティが向上した。
- WPA
    - Wi-Fi Protected Access
    - ESSIDを導入
    - TKIPを導入
        - セッションごとに暗号鍵を自動的に更新する
    - キーは一定時間ごとに更新される
- WPA2
    - 暗号化アルゴリズムとしてAESを導入
        - DESの後継
        - 最大256ビット鍵が使える共通鍵暗号
        - TKIPのRC4より安全
            - WEPキーとIVを組み合わせた情報
    - パーソナルモードとエンタープライズモード
        - パーソナルモード
            - 事前共有鍵を使う方式
        - エンタープライズモード
            - IEEE802.1X認証
            - RADIUS認証サーバ
                - 無線LANにおいては、アクセスポイントが認証サーバの役割を担う
- IEEE802.1X認証
    - クライアントが認証を要求
    - サーバが要求を受け、応答する
    -  ユーザーごとに異なる暗号鍵を配布する
    - 認証はRADIUSサーバで行う。

### SSL
- デジタル証明書を使い、サーバ／クライアント認証が行える
- 認証の手順
    - サーバは公開鍵の正当性を証明するために、認証局に登録申請を行う。
    - 認証局はデジタル証明書を発行し、サーバは認証される
    - クライアントがサーバーにアクセスすると、サーバーは認証局の署名付きのサーバー証明書を変換する。
    - クライアントは証明証の確認を認証局の公開回鍵で複合し、サーバー証明書が正当であることを確認する。
    * 正当性が証明されれば、クライアントで乱数を生成し、サーバ証明書の公開鍵で暗号化してWEBサーバに送る
    * ウェブサーバーは秘密鍵で乱数を復号化する。
    * サーバ、クライアント間でマスターシークレットを生成し、マスターシークレットを基にした共通鍵で暗号化通信を行う。
### パスワード認証
#### 攻撃
* 辞書攻撃
	* 辞書にある単語からパスワードを割り出す。
* ブルートフォース攻撃
	* いわゆるDOS攻撃
#### チャレンジレスポンス認証
* クライアントがユーザーIDを送信
* サーバは使い捨ての乱数であるチャレンジコードをクライアントに返す
* サーバから返されたチャレンジコードとパスワードをハッシュ化し、サーバに返信する
* サーバ内でチャレンジコードとパスワードをハッシュ化値と、クライアントから送信された値を比較して認証を行う。
* ハッシュ値だけで通信を行うため、盗聴に対して安全。（盗聴されても複合できない。）

#### ワンタイムパスワード
* クライアントとサーバとで同じアルゴリズムでトークンからパスワードを生成して認証を行う
* アルゴリズムにはタイムスタンプが利用される。

#### バイオメトリクス認証
* 指紋
	* 光学センサーや静電式センサで指紋を読み取り、特徴点抽出式やパターンマッチングで照合する
* 声紋
	* 声の個人特有の波形を利用して識別する。風邪や加齢で認証できないことも。
* 虹彩
	* 虹彩のパターンを利用して認証を行う。網膜の血管パターンで照合する方法もある。

### リモートアクセス
* 遠距離から特定のLANやコンピュータに接続してファイルアクセスやコンピュータの操作を行う。
* リモートアクセスサーバーを利用してコンピュータを利用する。
* 外部からの接続を許可するためにセキュリティ上の弱点になりやすい。

### PPP認証の技術
* 電話回線で二点間をつなぐデータリンク層のプロトコル
* [HDLC手順](http://e-words.jp/w/HDLC.html)がベースになっている
* インターネットに接続する際の一般的なプロトコル
* IP以外のパケットも伝送可能。
* 認証プロトコルにはPAPとCHAPが利用される。
* PAP
	* Password Authentication Protocol
	* 平文で認証データを送信する。
* CHAP
	* Challenge Handshake Authentication Protocol
	* チャレンジレスポンス認証で暗号化した認証データを送信する。
	* PPPリンクの確立後、言っての周期でチャレンジメッセージを送って相手を認証する。
	* 現在のPPP対応機器はほとんどがCHAPをサポートしている。

### RADIUS認証システム
* リモートアクセス時はリモートアクセスサーバーが脆弱性になる
* ユーザーIDやパスワードが蓄積されているので、攻撃された時の被害が大きい。
* RADIUS
	* Remote Authentication Dial-In User Service
	* RADIUSクライアントがユーザーからのアクセスを受け付け、RADIUS認証サーバに対して認証を行うことで脆弱性を緩和する。
	* 認証情報の復号化はRADIUS認証サーバーで行う。
	* もしRADIUSクライアントがクラッキングされても暗号文しか取得できないので比較的安全。
	* RADIUS認証サーバーでユーザー情報を一元管理できるメリットも有る。

### シングルサインオン
* ユーザー認証を一度だけ行えば、他の複数のサーバにもアクセスできる仕組み
* Cookie型
	* Cookieと呼ばれるテキスト情報をクライアントに保存し、サーバーに要求されればそれを使って認証を行う。
* リバースプロキシ
	* リバースプロキシが認証を代行する
	* 公開鍵認証で認証を行う
	* (ていうかアクセスする口がリバースプロキシになるというだけの話？)

* SAML型
	* アプリケーション連携を行うためのXMLの仕様
	* 古そう

### その他の認証方法
* 電話番号をを事前に登録しておき、かけ直すことで本人確認を行うコールバック
* 発信者番号情報を要求して電話番号に寄っての本人確認を行う
* 閉域接続
	* 通信業者が提供する特定ユーザーどうしのグルーピングサービス。グループ内でしか通話を許可しない、あるグループに対しての着発信を制限するなどの機能がある。

### デジタル署名
* メールなどは改ざんやなりすましが簡単
* 確かに本人が発信したものであるという証明

#### デジタル署名の基本的なな仕組み
* デジタル署名は、秘密鍵で平文を暗号化してデジタル署名を作り、平文とデジタル署名を受信者に送信する。
* 受信者は、送信者の公開鍵で証明書を複合し、平文と照合することで送信者であることを確認する。
* 実際には平文はハッシュ化される。
* 平文も送信時には暗号化される。

#### メッセージダイジェスト
* 平文が長くなるとデジタル署名も長くなる
* メッセージダイジェストでデジタル署名の長さを固定する。
* MD2,MD5,SHA-1などのハッシュ関数がある（SHA-1は脆弱性が確認されているため、現在はSHA-2が主流）
* 受信者が照合する際は、平文を同じハッシュ関数でハッシュ化して照合する。

#### PKI
* Public Key Infrastructure
* 公開鍵暗号方式を利用した認証と盗難防止基盤
* 公開鍵を利用した証明書の作成、管理、格納、配布、破棄に必要な方式、システム、プロトコル、ポリシの集合によって実現される
* 第三者機関である認証局がデジタル証明書を発行して、公開鍵が正当な送信者のものであることを保証する。
* 手順
	* 送信者は認証局に公開鍵を提出して、証明書発行を依頼する
	* 認証局は申請書類等に基づき公開鍵が所有者本人のものかどうかを審査して、デジタル証明書を発行する
	* デジタル証明証には以下のものは付加される
		* 公開鍵
		* 所有者情報
	* 送信者は受信者にデジタル証明書を送信する
	* 受信者はそれを認証局の公開鍵で複合し、デジタル証明書中の情報と認証局の署名を確認すると同時に、送信者の公開鍵を入手する。
* 有効期限内に何らかの理由で執行したデジタル証明書のシリアル番号は、CRLに登録

### コンピュータウィルス
* ユーザーに隠蔽される形でメモリや補助記憶媒体に保存されるプログラム
* 自己伝染機能
	* 他のシステムに自身をコピーする
* 潜伏機能
	* ウィルスとして機能するまでにインターバルがある
* 発病機能
	* メッセージの表示やファイルの破壊等の動作を行う。
* ウィルスは以下のように定義される
	* ウィルス（狭義）
		* 他のプログラムに寄生する
	* ワーム
		* 他のプログラムに依存せず、独立して破壊活動を行い、自己増殖する。
	* トロイの木馬
		* 通常は有用なプログラムとして機能するが、発病すると破壊活動や増殖を行う

#### 感染経路
* メール、インターネット
* セキュリティホール
	* ソフトウェアに存在する脆弱性
* バックドア
	* ポートの設定変更など
* マクロ
	* Excelマクロなどに潜む

#### ウィルスチェックソフト
* パターンファイルでメールやウェブサイトの閲覧データを常時チェックする
* パターンと合致すればウィルスと判断する。
* パターンファイルは常に最新に更新する必要がある。
* ビヘイビア法
	* プログラムを実行して、ウィルスと似た振る舞いを行えばウィルスとして検知する。
	* 動的ヒューリスティック法とも呼ばれる

#### セキュリティパッチ
* セキュリティ上の問題を解決するプログラム

#### コンピュータウィルス対策基準
* ユーザーへの啓蒙教育も含めたウィルス対策への取り組み
	* 出所不明のソフトウェアは利用しない
	* バックアップを定期的に行う
	* 感染した場合は管理者に連絡する
	* システム復旧も管理者の指示に従う。

### 脅威とリスク
#### セキュリティの捉え方
* 機密性
	* 許可された正当なユーザーのみがアクセスできること
	* アクセスコントロールはこのために行う。
* 完全性
	* 情報が完全で、改ざん、破壊されていないことを保証すること
* 可用性
	* ユーザーが情報が必要なときに利用可能な状態であることを保証すること

#### 脅威
* 不正アクセス
	* システム利用者が許可を得ている以上の行為をネットワークを通して行うこと
* ポートスキャン
	* 対象のコンピュータのすべてのポートにパケットを送信して、バックドアを検証する。
* ディレクトリトラバーサル攻撃
	* 相対パスなどで公開していないディレクトリにアクセスすること。
	* 入力値のチェックで対策する
* セキュリティホール攻撃
	* システムの脆弱性を突く
	* バッファオーバーフロー攻撃などが代表的
		* 許容量を超えたデータを送りつけてバッファをオーバーフローさせる。

#### その他の攻撃方法
* ソーシャルエンジニアリング
	* 技術的でない方法で情報を盗み取る
	* ショルダーハッキング
	* システム管理者に他社を装って問い合わせる
	* 書類から情報を得る
* 盗聴
	* スニッフィング
* サイドチャネル攻撃
	* 暗号化装置から得られる物理量、エラーメッセージ等から機密情報を取得する
	* 暗号化、復号化の処理時間から鍵を推測するタイミング攻撃など
* サラミ法
	* 1円ずつ口座から詐取するなど、表面化しないように少しずつ詐取する方法。
* IPスプーフィング
	* IPアドレス偽造
	* ルータ、ファイアウォールなどでIPをフィルタリングする
	* IPフィルタリングを突破されることがある。
* DoS攻撃
	* 正規のサービス要求を大量に繰り返す
* フィッシング
* DNSキャッシュポイズニング
	* DNSサーバーにニセのドメイン情報をキャッシュさせ、ほかのサイトに誘導する。
	* DNSサーバーからの応答に公開鍵暗号方式で証明するDNSSECなど。
* テンペスト技術
	* ディスプレイやケーブルなどから発せられる微弱電流から情報を読み取る
* リプレイ攻撃
	* 正規のパケットをコピーして同じリクエスト行う
	* なりすまし
* ボット
	* DDoS攻撃を指す
* 標的型攻撃
	* 特定の組織や個人に対して行われる攻撃、
		* 特定の目的のために執拗に攻撃を繰り返すことをAPT(Advanced Threats)という
* スパムメール
	* 不特定多数のユーザーに対して送られるメール。
	* 経由するサーバーにも負荷がかかる
	* メールの送信(TCP)に使われる25ポートを遮断することで拡散を防ぐことができる
* XSS
	* ユーザー入力によって特定のコードを実行させる
* SQLインジェクション
	* ユーザー入力に寄ってシステムが実行するSQLを書き変える
	* ;や'のサニタイズや、SQLをプリペアドステートメントで実行することで対策できる。
		* バインド機構とも呼ばれる

### 対策機器など
* IDS
	* Intrusion Dtection System
	* 侵入検知システム
	* シグネチャ型
		* 攻撃パターンと通信パケット既知のデータとマッチングさせて判定する
	* アノマリー型
		* 正しい物は変化しない
		* 通常のパターン以外は全て異常と判断する
		* 誤検知が多い
* NIDS
	* ネットワークを監視する
	* 不正なパケットや異常な通信料を検知する。
* HIDS
	* ホストにインストールしてそのホストを監視する。
	* シグネチャのパターンマッチング対策が施されたパケット紋検出できる
* IPS
	* 検知だけでなく、通信の社団などの対策も行う
* ハニーポット
	* ダミーとして使われる。攻撃元のログを取ることが目的
* WAF
	* WebApplicationFirewall
	* ウェブアプリケーションのやり取りを監視
	* ブラウザからの通信愛用を検査
	* 不正なら遮断

### リスクマネジメント
* 効率的なセキュリティ管理
	* 危険度の高いリスクには重点的に経営資源を投入するなど、メリハリを付ける。
* デジタルフォレンジックス
	* コンピュータ犯罪が起きた、法的な証拠になりうるデータを保全、収集、分析する技法
* リスク分析
	* 組織の持つ
		* 情報資産の価値
		* 脅威
		* 脆弱性
		* を明らかにし、
	* リスクが起こった時の
		* 損失程度
		* 損失額
		* 業務への影響
		* を見極める
	* 手順
		* 分析対象の理解と分析計画
		* 脆弱性の発見と識別
		* 事項態様の関連分析と損失額予想
		* 損失の分類と影響度の評価
		* 対策の検討・評価と優先順位の決定
* 様々な分析手法
	* JIPDEC(日本情報処理開発協会)が開発したJRAM
		* 脆弱性分析
		* 実態分析
	* 米国立標準技術院が開発したALE
* 純粋リスク
	* 単にデメリットしかない
* 登記リスク
	* 利益を生む可能性に隣接する
* リスク評価
	* どのリスクが最も危険か
	* 優先順位をどうつけるか
	* 定量的評価
		* 予想損失額 × 発生確率をリスク評価額としてリスク値を算定する
	* 定性的評価
		* 情報資産の価値、脅威、脆弱性の相対的評価値の積
* リスク対応
	* リスクコントロール
		* 事前防止
		* 被害を最小限に
	* リスクファイナンス
		* 資金対策
	* リスク回避
		* 要因の排除
	* リスク最適化
		* 発生の防止
		* 被害の最小化
	* リスク移転
		* 他社に移転
	* リスク保有
		* 対応コストの方が発生コストよりも高い場合、対応しないこと
	* リスク移転
		* 資金的リスクを他社に移転
	* リスク保有
		* 損失をお金で解決
### セキュリティ評価の標準化
	* ISO/IEC 15408
		* セキュリティ評価の国際基準
		* PP(セキュリティ要求仕様書)とST(セキュリティ基本設計書)を作成する
		* EAL1~EAL7の評価が与えられる
			* EAL5は軍事用など
	* ISMS
		* セキュリティ運用体制の規定
		* ISO/IEC 27001など
		* ガイドラインと認証基準
		* ガイドラインをベスプラクティスとして、企業は実情に合わせたセキュリティマネジメントシステムを制作する。
		* 認証基準でセキュリティマネジメントシステムを審査する
			* 国内ではJIS Q 27001が使われる
			* PDCAサイクルを元に策定されている。
	* 情報セキュリティポリシー
		* 文書で策定
		* 基本方針と対策基準が含まれる
			* 基本方針は全社的に適応される指針
			* 対策基準は部署ごとに策定される具体的な指針
		* コンティンジェンシープラン
			* 緊急事態を想定して策定する対応策


1. エ◯
2. ウ◯
3. エ◯
4. ウ◯
5. エ◯
6. ウ☓ ア
7. ウ☓ ア
8. ア☓ エ
9. わからん☓
10. ア◯
11. ア☓
12. 1.イ 2.ア 3.エ 4.オ 5.ウ 6.キ ◯


1. イ ☓ア
2. ウ、イ、わからん
3. イ、ウ 逆
4. 予め安全な通信パターンを定義しておく

1. 誤判定によって必要なメールが届かない ◯
2. ブラックリスト ◯

1. キ◯
2. オ◯

イ、ウ ◯ ◯

VPNに限定することで感染拡大を防ぐことができる